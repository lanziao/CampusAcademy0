<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>task15</title>
</head>

<body>

<ul id="source">
    <li>北京空气质量：<b>90</b></li>
    <li>上海空气质量：<b>70</b></li>
    <li>天津空气质量：<b>80</b></li>
    <li>广州空气质量：<b>50</b></li>
    <li>深圳空气质量：<b>40</b></li>
    <li>福州空气质量：<b>32</b></li>
    <li>成都空气质量：<b>90</b></li>
</ul>

<ul id="resort">
    <!-- 
    <li>第一名：北京空气质量：<b>90</b></li>
    <li>第二名：北京空气质量：<b>90</b></li>
    <li>第三名：北京空气质量：<b>90</b></li>
     -->

</ul>

<button id="sort-btn">排序</button>

<script type="text/javascript">

	var oUl = document.getElementById('source');
	var oLi = oUl.getElementsByTagName('li');
	var oBtn = document.getElementById('sort-btn');
	
	
	
	
/**
 * getData方法
 * 读取id为source的列表，获取其中城市名字及城市对应的空气质量
 * 返回一个数组，格式见函数中示例
 */
	
	function getData() {
		
		var str;//声明变量
		var data = new Array();//声明数组

		
		for(var i=0;i<oLi.length;i++) {
			data[i]=new Array();
            data[i][0]=oLi[i].innerHTML.substring(0,oLi[i].innerHTML.indexOf("空"));
            var b=oLi[i].getElementsByTagName("b");
            data[i].push(parseInt(b[0].innerHTML));
			
		};//？？？
		
		
//		while(oLi[i]!=undefined) /*判断oLi[i]是否存在？*/ {
//			str = oLi[i].innerText;//提取符合循环条件的oLi里的内容并去出HTML标签。W3C标准代替：str = oLi[i].innerHTML.replace(/<.+?>/gim,'')；
//			data.push(str); //把str的参数顺序添加到data这个数组的尾部。必须最少添加一个。
//			i++;
//		};

	  /*
	  coding here
	  */

	  /*
	  data = [
		["北京", 90],
		["北京", 90]
		……
	  ]
	  */
		

	  return data;

	};

	/**
	 * sortAqiData
	 * 按空气质量对data进行从小到大的排序
	 * 返回一个排序后的数组
	 */
	function sortAqiData(data) {
		
		data.sort(function ascend(x,y){
    		return x[1]-y[1];
		});
		
		return data;
	};
	


	/**
	 * render
	 * 将排好序的城市及空气质量指数，输出显示到id位resort的列表中
	 * 格式见ul中的注释的部分
	 */
	function render(data) {
		var i;
		var oNewUl = document.getElementById('resort');
		
		for (i = 0; i < data.length; i++) {
			var oNewLi = document.createElement('li');//声明变量oNewLi为创建标签li
			oNewLi.innerHTML = "第"+(i+1)+"名："+data[i][0]+"空气质量："+data[i][1];;//设置创建的标签li里的内容
			oNewUl.appendChild(oNewLi);//***添加节点.
		}
	};

	function btnHandle() {
		var aqiData = getData();
		aqiData = sortAqiData(aqiData);
	  	render(aqiData);
	};


	function init() {

	  // 在这下面给sort-btn绑定一个点击事件，点击时触发btnHandle函数
		
		oBtn.onclick = function () {
			btnHandle();
		};
	};

	init();

</script>

</body>
</html>
